---
lab:
    title: '使用数据存储'
    module: '模块 2:使用数据存储'
---

# DP 200 - 实施数据平台解决方案
# 实验室 2  - 使用数据存储

**预计用时**：60 分钟

**先决条件**：假设已阅读了本实验室的案例研究。假设模块 1 的内容和实验：数据工程师的 Azure 也已完成

**实验室文件**：本实验室文件位于_Allfiles\Labfiles\Starter\DP-200.2_文件夹。

## 实验室概述

在本实验室中，学生将能够根据一组给定的业务和技术要求确定适当的存储类型。他们将能够创建 Azure 存储帐户和 Data Lake Storage 帐户，并解释 Data Lake Storage 版本 1 和版本 2 之间的区别。他们还将能够演示如何将数据加载到所选的数据存储中。

## 实验室目标
  
完成本实验室课程后，你将能够：

1. 在 Azure 中选择数据存储方法
1. 创建 Azure 存储账户
1. 解释 Azure Data Lake Storage
1. 将数据上传到 Azure Data Lake

## 方案
  
你已被聘为高级数据工程师，以实施技术解决方案，这是数字转换项目的一部分。该组织正在将管理公司网站的互联网信息服务（IIS）迁移到Azure。开发人员正在将Web应用程序及其逻辑传输到Azure Web Apps，并且他们已经要求你为它们准备可用于托管网站上使用的静态图像的数据存储处。

此外，信息服务部门已告知你：他们的团队正在扩展，他们很快就会纳入数据科学家，他们将开始构建预测分析解决方案。你已被要求设置一项解决方案，用于托管其工作的生产环境。在第一个实例中，你将评估为解决方案创建的适当存储层。

在此工作结束时，你将能够：

1. 在 Azure 中选择数据存储方法
2. 创建 Azure 存储账户
3. 解释 Azure Data Lake Storage
4. 将数据上传到 Azure Data Lake

> **重要事项**：在完成本实验室时，请记下你在任何设置或配置任务中遇到的任何问题，并将其记录在位于 _\Labfiles\DP-200-Issues-Doc.docx_ 的文档的表格中。记录实验室编号，记录技术，说明问题以及解决方案的内容。保存该文档，以便在稍后的模块中参考它。

## 练习 1：在 Azure 中选择数据存储方法

预计用时：15 分钟

个人练习
  
本练习的主要任务如下：

1. 从案例研究中，确定针对网站静态图像和预测分析解决方案的数据存储要求。

1. 教师将与小组讨论结果。

### 任务 1：确定 AdventureWorks 的数据存储要求和结构。

1. 从实验室虚拟机中，启动 **Microsoft Word**，然后从 **Allfiles\Labfiles\Starter\DP-200.2** 文件夹中打开文件 **DP-200-Lab02-Ex01.docx**。

1. 花 **10 分钟** 记录本实验室方案中概述的数据存储要求。你还可以使用案例研究文档作为其他参考。

### 任务 2：与教师讨论结果

1. 教师将使小组停下来讨论结果。

> **结果**：完成本练习后，你已创建一个 Microsoft Word 文档，其中显示两个数据存储要求表。

## 练习 2：创建 Azure 存储账户
  
预计用时：20 分钟

个人练习
  
本练习的主要任务如下：

1. 在距离实验室最近的位置创建名为 **awrgstudxx** 的 Azure 资源组，其中 **XX** 是你的姓名缩写。

1. 在距离实验室最近的位置创建并配置名为 **awsastudxx** 的存储账户，其中 **XX** 是你的姓名缩写。

1. 在 awsastudxx 存储帐户中创建名为 **图片** 和 **数据** 的容器。

1. 将一些图形上载到存储帐户的图像容器中。

### 任务 1：创建和配置资源组。

1. 从实验室虚拟机启动 Microsoft Edge，浏览 Azure 门户[**http://portal.azure.com**](http://portal.azure.com)并使用已分配给你的账户登录课程。

1. 在 Azure 门户中，导航到 **资源组** 边栏选项卡。

1. 从 **资源组** 边栏选项卡，使用以下设置创建第一个资源组：

    - 资源组名称：**awrgstudxx**，其中 **XX** 是你的姓名缩写。

    - 订阅：你用于本实验室的订阅名称

    - 资源组位置：最靠近实验室位置的 Azure 区域的名称，在其中你能设置 Azure VM 的位置。

      > **注**：要识别你的订阅中可用的 Azure 区域，请参阅[**https://azure.microsoft.com/zh-cn/regions/offers/**](https://azure.microsoft.com/zh-cn/regions/offers/)

### 任务 2：创建和配置存储帐户。

1. 在 Azure 门户中，导航到 **创建资源** 边栏选项卡。

1. 在新的边栏选项卡中，导航到 **搜索市场** 文本框，然后输入单词 **存储**。在显示的列表中点击 **存储帐户**。

1. 在 **存储帐户** 边栏选项卡上，单击 **创建**。

1. 从 **创建存储帐户*** 边栏选项卡使用以下设置创建第一个存储帐户：

    - 资源组名称：**awrgstudxx**，其中 **XX** 是你的姓名缩写。

    - 订阅：你用于本实验室的订阅名称

    - 存储帐户名称：**awsastudxx**，其中 **XX** 是你的姓名缩写。

    - 位置：最靠近实验室位置的 Azure 区域的名称，在其中你能设置 Azure VM 的位置。

    - 性能：**标准**。

    - 帐户类型：**StorageV2（通用v2）**。

1. 在 **创建存储帐户*** 边栏选项卡中，单击 **审查+创建**。

1. 确认 **创建存储帐户*** 边栏选项卡后，单击 **创建**。

   > **注**：创建存储帐户大约需要 90 秒，同时根据你定义的设置配置磁盘和磁盘配置。

### 任务 3：在存储帐户中创建和配置容器。

1. 在 Azure 门户中，消息说明_你的部署已完成_，单击按钮 **转到资源**。

1. 在 **awsastudxx** 屏幕中，其中 **XX** 是你的姓名缩写，在 **服务** 下单击 **Blobs**。

1. 在 **awsastudxx  -  Blobs** 屏幕中，在左上角单击 **+容器** 按钮。

1. 在 **新容器*** 屏幕中，使用以下设置创建容器：

    - 名称：**图片**。

    - 公共访问级别：**私人（无匿名访问）**

1. 在 **新容器*** 屏幕，单击 **OK**。

   > **注**：立即创建容器，容器将出现在 **awrgstudxx  -  Blobs** 屏幕的列表中。

1. 重复步骤 4 -5 以创建名为 **数据** 的容器，公共访问级别为 **私人（无匿名访问）**

1. 重复步骤 4 -5 以创建名为 **推文** 的容器，公共访问级别为 **私人（无匿名访问）**

### 任务 4：将一些图形上载到存储帐户的图像容器中。

1. 在 Azure 门户中，在 **awsastudxx  -  Blobs** 屏幕中，单击列表中的 **图片** 项目。

1. 在 **图片** 屏幕中，单击 **上传** 按钮。

1. 在 **上传 blob** 屏幕中，在文件文本框中，单击文本框右侧的 **文件夹** 图标。

1. 在 **打开** 对话框中，浏览 **Labfiles\Starter\DP-200.2\website graphics** 文件夹。突出显示以下文件：

    - one.png

    - two.png

    - three.png

    - No.png

1. 在 **打开** 对话框中，单击 **打开**。 

1. 在 **上传 blob** 屏幕中，单击 **上传** 按钮。

1. 关闭 **上传 blob** 屏幕，并关闭 **图片** 屏幕。

1. 在Azure门户中，在 **awsastudxx  -  Blobs** 屏幕中，单击列表中的 **数据** 项目。

1. 在 **数据** 屏幕中，单击 **上传** 按钮。

1. 在 **上传 blob** 屏幕中，在文件文本框中，单击文本框右侧的 **文件夹** 图标。

1. 在 **打开** 对话框中，浏览 **Labfiles\Starter\DP-200.2\Static files** 文件夹。突出显示 **DimDate2.txt** 文件。

1. 在 **打开** 对话框中，单击 **打开**。 

1. 在 **上传 blob** 屏幕中，单击 **上传** 按钮。

1. 关闭 **上传 blob** 屏幕，在 Azure 门户中，导航到 **主页** 边栏选项卡 

   > **注**：上传文件将大约需要 5 秒。完成后，它们将出现在上传 blobs 屏幕的列表中。

> **结果**：完成本练习后，你已创建一个名为 awsastudxx 的存储帐户，该帐户具有一个名为“图片”的容器，其中包含四个可以在 AdventureWorks 网站上使用的图形文件。

## 练习 3：解释 Azure Data Lake Storage
  
预计用时：15 分钟

个人练习
  
本练习的主要任务如下：

1. 在距离实验室最近的位置创建并配置名为 **awdlsstudxx** 的存储账户，作为 Data Lake Store Gen II 存储类型，其中 **xx** 是你的姓名缩写。

1. 在 awdlsstudxx 存储帐户中，创建名为 **数据** 的文件系统。

1. 将一些数据文件上载到存储帐户的数据容器中。

### 任务 1：创建存储帐户并将其配置为 Data Lake Store Gen II 存储。

1. 在 Azure 门户中，导航到 **创建资源** 边栏选项卡。

1. 在新的边栏选项卡中，导航到 **搜索市场** 文本框，然后输入单词 **存储**。在显示的列表中点击 **存储帐户**。

1. 在 **存储帐户** 边栏选项卡上，单击 **创建**。

1. 从 **创建存储帐户*** 边栏选项卡使用以下设置创建第一个存储帐户：

    - 资源组名称：**awrgstudxx**，其中 **XX** 是你的姓名缩写。

    - 订阅：你用于本实验室的订阅名称

    - 存储帐户名称：**awdlsstudxx**，其中 **XX** 是你的姓名缩写。

    - 位置：最靠近实验室位置的 Azure 区域的名称，在其中你能设置 Azure VM 的位置。

    - 性能：**标准**。

    - 帐户类型：**StorageV2（通用v2）**。

1. 在 **高级** 选项卡中，在 **分层命名空间** 下单击 **启用**。

1. 在 **创建存储帐户*** 边栏选项卡中，单击 **审查+创建**。

1. 确认 **创建存储帐户** 边栏选项卡后，单击 **创建**。

   > **注**：创建存储帐户大约需要 90 秒，同时根据你定义的设置配置磁盘和磁盘配置。

### 任务 2：在存储帐户中创建和配置文件系统。

1. 在 Azure 门户中，消息说明_你的部署已完成_，单击按钮 **转到资源**。

1. 在 **awdlsstudxx** 屏幕中，其中 **xx** 是你的姓名缩写，在 **服务** 下单击 **Data Lake Gen2文件系统**。

1. 在 **awrgstudxx - 文件系统** 屏幕中，在左上角单击 **+ 文件系统** 按钮。

1. 从 **添加文件系统** 屏幕使用以下设置创建文件系统：

    - 名称：**数据**。

1. 在 **添加文件系统*** 屏幕，单击 **OK**。

   > **注**：立即创建文件系统，文件系统将出现在 **awdlsstudxx  - 文件系统** 屏幕的列表中。

> **结果**：完成本练习后，你已创建名为 awdlsstudxx 的 Data Lake Gen II 的存储帐户，该帐户具有名为“数据”的文件系统。

## 练习 4：将数据上传到 Azure Data Lake。
  
预计用时：10 分钟

个人练习
  
本练习的主要任务如下：

1. 安装并启动 Microsoft Azure 存储资源管理器

1. 将一些数据文件上载到 Data Lake Gen II 存储帐户的数据容器。

### 任务 1：安装存储资源管理器

1. 在 Azure 门户中，在 **awdlsstudxx  - 文件系统** 屏幕中，单击列表中的 **数据** 项目。

1. 出现一个屏幕，说明 Azure Data Lake Storage Gen2 现在可在存储资源管理器中使用，单击 **下载Azure存储资源管理器** 链接。

1. 你将进入以下网页[Azure 存储资源管理器](https://azure.microsoft.com/zh-cn/features/storage-explorer/)，其中存在说明 **免费下载存储资源管理器** 的按钮。单击该按钮。

1. 在 Microsoft Edge 对话框中单击 **保存**，下载完成后，单击 **查看下载**，在 Microsoft Edge 的下载屏幕中，单击 **打开文件夹**。这将打开“下载”文件夹。

1. 双击该文件 **StorageExplorer.exe**，在“用户帐户控制”对话框中单击 **OK**。

1. 在“许可协议”屏幕中，选择 **我同意协议** 附近的单选按钮，然后单击 **安装**。

   > **注**：存储资源管理器的安装大约需要 4 分钟。Azure 存储资源管理器允许你使用存储资源管理器轻松管理存储帐户的内容。上传、下载和管理 blob、文件、队列、表和 Cosmos DB 实体。它还使你可以轻松访问，以管理虚拟机磁盘。

1. 完成安装后，确保选择了 **启动 Microsoft Azure 存储资源管理器** 附近的复选框，然后单击 **完成**。Microsoft Azure 存储资源管理器打开并列出你的订阅项。

1. 在存储资源管理器中，选择 **“管理账户”**，然后转至 **“账户管理面板”**。

1. 左侧窗格现显示你已登录的所有 Azure 帐户。要连接到其他帐户，请选择 **“添加账户”**。

1. 想要登录国家云或 Azure 堆栈，请单击 Azure 环境下拉列表，选择要使用的 Azure 云。选择环境后，单击 **Sign in...** 按钮。

1. 成功登录 Azure 帐户后，该帐户和与该帐户关联的 Azure 订阅将添加到左窗格中。选择要使用的 Azure 订阅，然后选择 **应用**。左窗格显示与所选 Azure 订阅关联的存储帐户。

### 任务 2：将数据文件上传到 Data Lake Gen II 存储帐户的数据容器。

1. 在 Azure 存储资源管理器中，单击箭头以展开你的订阅。

1. 在 **存储帐户** 下，搜索存储帐户 **awdlsstudxx（ADLS Gen2）**，然后单击箭头将其展开。

1. 在 **Blob 容器** 下，单击箭头将其展开并显示 **数据** 文件系统。单击 **数据** 文件系统。

1. 在 Azure 存储资源管理器中，单击 **上传** 图标旁边的箭头，然后单击 **上传文件..**。

1. 在“上传文件”对话框中，单击 **选定的文件** 文本框旁边的省略号。

1. 在 **选择待上传的文件** 对话框中，浏览 **Labfiles\Starter\DP-200.2\logs** 文件夹。突出显示以下文件：

    - weblogsQ1.log

    - weblogsQ2.log

    - preferences.json

1. 在 **选择待上传的文件** 对话框中，选择 **打开**。

1. 在 **上传文件** 屏幕中，单击 **上传** 按钮。

   > **注**：上传文件将大约需要5秒。你将在 Azure 存储资源管理器中看到消息，其说明 **你的视图可能缺少数据。你想刷新吗？单击“是”**。完成后，所有三个文件将显示在上传 blobs 屏幕的列表中。

1. 关闭 Azure 存储资源管理器。

1. 返回 Azure 门户，然后导航到 **主页** 边栏选项卡。

> **结果**：完成本练习后，你已创建名为 awdlsstudxx 的 Data Lake Gen II 的存储帐户，该帐户具有名为“数据”的文件系统，其中包含两个可供 AdventureWorks 数据科学家使用的博客文件。